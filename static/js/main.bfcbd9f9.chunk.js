(this["webpackJsonptetrastylon-public-site-source"]=this["webpackJsonptetrastylon-public-site-source"]||[]).push([[0],{306:function(e,t,n){},307:function(e,t,n){},384:function(e,t,n){},386:function(e,t,n){"use strict";n.r(t);var c,s=n(38),i=n.n(s),a=n(86),r=n(57),o=n(216),l=n(8),d=function(){return Object(l.jsx)("div",{children:"Error!"})},j=n(84),h=function(){return Object(l.jsx)("div",{className:"house loading",children:Object(l.jsxs)("div",{className:"spinner",children:[Object(l.jsx)(j.a,{}),Object(l.jsx)("div",{className:"label",children:"Loading"})]})})},u=n(53),b=n(0),m=n(395),x=n(139),O=n(390),p=n(396),g=n(391),v=n(397),_=n(398),f=n(399),y=n(71),N=n.n(y),w=n(202),C=n.n(w),k=n(393),S=function(e){var t=Object(b.useState)(!1),n=Object(u.a)(t,2),c=n[0],s=n[1],i=Object(b.useState)(-1),a=Object(u.a)(i,2),o=a[0],d=a[1],j=e.images.map((function(e){return Object(r.a)(Object(r.a)({},e),{},{src:"".concat("https://db.tetrastylon.eu","/assets/").concat(e.directus_files_id.id,"?width=1200"),thumb:"".concat("https://db.tetrastylon.eu","/assets/").concat(e.directus_files_id.id,"?width=200&height=200")})})),h=function(e){return Array.from(e).filter((function(e){return null!=e.offsetParent}))[0]};Object(b.useEffect)((function(){var e=h(document.getElementsByClassName("ant-image-preview-switch-left")),t=h(document.getElementsByClassName("ant-image-preview-switch-right")),n=function(){var e=h(document.getElementsByClassName("ant-image-preview-img"));return j.indexOf(j.find((function(t){return t.src==e.getAttribute("src")})))};if(e&&t){d(n());var c=function(){return d(Math.max(0,n()-1))},s=function(){return d(Math.min(n()+1,j.length-1))};return e.addEventListener("click",c),t.addEventListener("click",s),function(){e.removeEventListener("click",c),t.removeEventListener("click",s)}}d(-1)}),[c]);var m=c&&j&&o>-1?j[o].directus_files_id:{},x=m.title,O=m.description;return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(k.a.PreviewGroup,{preview:{onVisibleChange:function(e){return s(e)}},children:j.map((function(e){return Object(l.jsx)(k.a,{width:200,src:e.thumb,preview:{src:e.src}},e.id)}))}),(x||O)&&Object(l.jsx)("div",{className:"image-caption-wrapper",children:Object(l.jsxs)("div",{className:"image-caption",children:[x&&Object(l.jsx)("h4",{children:x}),O&&Object(l.jsx)("p",{children:O})]})})]})},E=n(78),I=n(145),F=function(e){return Object(l.jsxs)("nav",{style:{backgroundImage:'url("/logo_navbar.png")'},children:[Object(l.jsx)(E.b,{className:"nav-item-wrapper",to:"/search",children:Object(l.jsx)("div",{className:"nav-item",children:Object(l.jsxs)(x.a,{title:"Search",children:[Object(l.jsx)(I.a,{}),Object(l.jsx)("span",{children:"Search"})]})})}),Object(l.jsx)(E.b,{className:"nav-item-wrapper",to:"/",children:Object(l.jsx)("div",{className:"nav-item",children:Object(l.jsxs)(x.a,{title:"Home",children:[Object(l.jsx)(v.a,{}),Object(l.jsx)("span",{children:"Home"})]})})})]})},A=(n(306),"https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}"),L="https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",T=function(e){var t=window.location.port?":".concat(window.location.port):"",n="".concat(window.location.protocol,"//").concat(window.location.hostname).concat(t,"/house/").concat(e.id);return Object(l.jsxs)("span",{children:[e.user_created.last_name,", ",e.user_created.first_name.substring(0,1),'., "',e.house_name,'", Tetrastylon, ',new Date(e.date_updated).getUTCFullYear(),", ",Object(l.jsx)("a",{href:n,children:n}),"."]})},M=function(){var e=document.querySelector(".section.cite-as p");C()(e.innerHTML,{asHtml:!0})},B=function(e){var t=Object(b.useState)(A),n=Object(u.a)(t,2),c=n[0],s=n[1],i=e.images.map((function(e){return e.directus_files_id})),a=i.length>0?"url('".concat("https://db.tetrastylon.eu","/assets/").concat(i[0].id,"?width=1400&height=600')"):null,r=[e.latitude,e.longitude];return Object(l.jsxs)("div",{className:"house loaded",children:[Object(l.jsxs)("header",{children:[Object(l.jsx)(F,{}),Object(l.jsxs)("div",{className:"jumbo",style:{backgroundImage:a},children:[Object(l.jsxs)("div",{className:"jumbo-contents",children:[Object(l.jsx)("h1",{children:e.house_name}),Object(l.jsx)("h2",{children:e.city})]}),Object(l.jsx)("div",{children:Object(l.jsxs)("div",{className:"mini-map",children:[Object(l.jsxs)(O.a,{center:r,zoom:5,zoomControl:!1,attributionControl:!1,children:[c==A&&Object(l.jsx)(p.a,{url:c}),c==L&&Object(l.jsx)(p.a,{url:c}),Object(l.jsx)(g.a,{position:r})]}),Object(l.jsx)("div",{className:"layer-toggle",children:Object(l.jsx)(m.a,{onChange:function(e){return s(e?L:A)},checkedChildren:"SATELLITE",unCheckedChildren:"STREET"})})]})})]})]}),Object(l.jsxs)("main",{children:[Object(l.jsx)("div",{className:"section key-properties",children:Object(l.jsxs)("ul",{children:[Object(l.jsxs)("li",{children:[Object(l.jsx)(v.a,{})," ",e.number_of_rooms," Rooms, ",parseFloat(e.house_dimensions).toFixed()," m\xb2"]}),Object(l.jsx)("li",{children:e.building_phases&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(_.a,{})," ",e.building_phases," Building Phase",e.building_phases.length>0&&"s"]})}),Object(l.jsxs)("li",{children:[Object(l.jsx)("label",{children:"Constructed"})," ",e.construction_date]}),Object(l.jsxs)("li",{children:[Object(l.jsx)("label",{children:"Abandonded"})," ",e.abandon_date]})]})}),Object(l.jsxs)("div",{className:"section description",children:[Object(l.jsx)("h3",{children:"Description"}),Object(l.jsx)(N.a,{children:e.house_description})]}),Object(l.jsxs)("div",{className:"section",children:[Object(l.jsx)("h3",{children:"Dating of Phases"}),Object(l.jsx)(N.a,{children:e.dating_of_phases})]}),Object(l.jsxs)("div",{className:"section",children:[Object(l.jsx)("h3",{children:"Situation of Entrance"}),Object(l.jsx)(N.a,{children:e.situation_of_entrance})]}),Object(l.jsxs)("div",{className:"section",children:[Object(l.jsx)("h3",{children:"Representation Room Typology"}),Object(l.jsx)(N.a,{children:e.representation_room_typology})]}),Object(l.jsxs)("div",{className:"section atrium",children:[Object(l.jsx)("h3",{children:"Atrium"}),Object(l.jsx)(N.a,{children:e.atrium_typology}),e.atrium_typology&&e.atrium_extension?", ":"",e.atrium_extension&&"".concat(parseFloat(e.atrium_extension).toFixed()," m\xb2"),!(e.atrium_extension||e.atrium_typology)&&"-"]}),Object(l.jsxs)("div",{className:"section",children:[Object(l.jsx)("h3",{children:"Impluvium Extension"}),e.impluvium_extension?"".concat(parseFloat(e.impluvium_extension).toFixed()," m\xb2"):"-"]}),Object(l.jsxs)("div",{className:"section",children:[Object(l.jsx)("h3",{children:"Other Uncovered Spaces"}),Object(l.jsx)(N.a,{children:e.other_uncovered_spaces})]}),e.comments&&Object(l.jsxs)("div",{className:"section",children:[Object(l.jsx)("h3",{children:"Comments"}),Object(l.jsx)(N.a,{children:e.comments})]}),e.images.length>0&&Object(l.jsxs)("div",{className:"section images",children:[Object(l.jsx)("h3",{children:"Images"}),Object(l.jsx)(S,{images:e.images})]}),e.plans_of_the_house.length>0&&Object(l.jsxs)("div",{className:"section plans",children:[Object(l.jsx)("h3",{children:"Plans of the House"}),Object(l.jsx)(S,{images:e.plans_of_the_house})]}),e.interesting_links&&e.interesting_links.length>0&&Object(l.jsxs)("div",{className:"section links",children:[Object(l.jsx)("h3",{children:"Interesting Links"}),Object(l.jsx)("ul",{children:e.interesting_links.map((function(e){return Object(l.jsx)("li",{children:Object(l.jsx)("a",{href:e.url,target:"_blank",children:e.description})},e.id)}))})]}),Object(l.jsxs)("div",{className:"section bibliography",children:[Object(l.jsx)("h3",{children:"Bibliography"}),Object(l.jsx)(N.a,{children:e.bibliography})]}),Object(l.jsxs)("div",{className:"section cite-as",children:[Object(l.jsx)("h3",{children:"Cite as"}),Object(l.jsxs)("p",{children:[T(e),Object(l.jsx)(x.a,{title:"Copy to Clipboard",children:Object(l.jsx)(f.a,{className:"copy",onClick:M})})]})]})]})]})},P=function(e){return fetch(e).then((function(e){return e.json()}))},q=function(e){var t=e.match.params.houseId,n=Object(o.a)("".concat("https://db.tetrastylon.eu","/items/house/").concat(t,"?fields=*,*.*,*.*.id,*.*.title,*.*.description"),P),c=n.data;return n.error?Object(l.jsx)(d,{}):c?Object(l.jsx)(B,Object(r.a)({},c.data)):Object(l.jsx)(h,{})},H=n(205),z=n(394),D=n(392),R=n(210),G=(n(307),function(e){var t;return(null===(t=e.images)||void 0===t?void 0:t.length)>0?"".concat("https://db.tetrastylon.eu","/assets/").concat(e.images[0].directus_files_id.id,"?width=120&height=120"):null}),J=function(e){var t=e.data,n=t&&t.map((function(e){return{key:e.id,image:G(e),house_name:e.house_name,city:e.city,constructed:{text:e.construction_date,numeric:e.construction_date_numeric},abandonded:{text:e.abandon_date,numeric:e.abandon_date_numeric},dimensions:e.house_dimensions,complete_plan:e.complete_plan}}));return Object(l.jsxs)(D.a,{loading:e.loading&&{indicator:Object(l.jsx)(R.a,{indicator:Object(l.jsx)(j.a,{})})},dataSource:n,pagination:!1,children:[Object(l.jsx)(D.a.Column,{title:"",dataIndex:"image",render:function(e){return Object(l.jsx)(k.a,{src:e,preview:!1})}}),Object(l.jsx)(D.a.Column,{title:"House Name",dataIndex:"house_name",render:function(e,t){return Object(l.jsx)(E.b,{to:"/house/".concat(t.key),children:e})}}),Object(l.jsx)(D.a.Column,{title:"City",dataIndex:"city"}),Object(l.jsx)(D.a.Column,{title:"Constructed",dataIndex:["constructed","text"]}),Object(l.jsx)(D.a.Column,{title:"Abandonded",dataIndex:["abandonded","text"]})]})},U=function(e){return Object(l.jsx)("div",{children:"Error"})};function W(e){var t,n=Object(a.useQuery)((t=e.query,Object(a.gql)(c||(c=Object(H.a)(['\n  query {\n    items {\n      house(search: "','", limit: 100) {\n        id,\n        house_name,\n        city,\n        latitude,\n        longitude,\n        construction_date,\n        construction_date_numeric,\n        abandon_date,\n        abandon_date_numeric,\n        complete_plan,\n        house_dimensions,\n        cistern,\n        images {\n          id,\n          directus_files_id {\n            id\n          }\n        }\n      }\n    }\n  }'])),t))),s=n.loading,i=n.error,r=n.data;return s?Object(l.jsx)(J,{loading:!0}):i?Object(l.jsx)(U,{}):Object(l.jsx)(J,{data:r.items.house})}var Q=function(e){var t=Object(b.useState)(),n=Object(u.a)(t,2),c=n[0],s=n[1];return Object(l.jsxs)("div",{className:"search",children:[Object(l.jsx)("header",{children:Object(l.jsx)(F,{})}),Object(l.jsxs)("main",{children:[Object(l.jsx)("div",{className:"search-bar",children:Object(l.jsx)(z.a.Search,{placeholder:"Search...",allowClear:!0,size:"large",onSearch:function(e){return s(e)}})}),Object(l.jsx)("div",{className:"search-results",children:c&&Object(l.jsx)(W,{query:c})})]})]})},V=function(e){return Object(l.jsx)("h1",{children:"Map"})},Y=n(31);n(384);var K=function(){return Object(l.jsx)(E.a,{children:Object(l.jsxs)(Y.c,{children:[Object(l.jsx)(Y.a,{path:"/search",component:Q}),Object(l.jsx)(Y.a,{path:"/house/:houseId",component:q}),Object(l.jsx)(Y.a,{path:"/map",children:Object(l.jsx)(V,{})}),Object(l.jsxs)(Y.a,{path:"/",children:[Object(l.jsx)("p",{children:"Future site of the Tetrastylon DB interface. Nothing to see yet."}),Object(l.jsx)(E.b,{to:"/house/65dcf6b5-d0a4-45c9-a466-c072d1351c93",children:"Example house"})]})]})})},X=(n(385),new a.ApolloClient({uri:"".concat("https://db.tetrastylon.eu","/graphql"),cache:new a.InMemoryCache({typePolicies:{items:{keyFields:[]}}})}));i.a.render(Object(l.jsx)(a.ApolloProvider,{client:X,children:Object(l.jsx)(K,{})}),document.getElementById("app"))}},[[386,1,2]]]);
//# sourceMappingURL=main.bfcbd9f9.chunk.js.map